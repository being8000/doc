"use strict";(self.webpackChunktauri_docs=self.webpackChunktauri_docs||[]).push([[9179],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return h}});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(a),h=i,c=d["".concat(s,".").concat(h)]||d[h]||m[h]||r;return a?n.createElement(c,o(o({ref:t},u),{},{components:a})):n.createElement(c,o({ref:t},u))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},39504:function(e,t,a){a.r(t),a.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return h},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return m}});var n=a(87462),i=a(63366),r=(a(67294),a(3905)),o=["components"],l={sidebar_position:3},s="Reducing the App Size",p={unversionedId:"guides/building/app-size",id:"guides/building/app-size",title:"Reducing the App Size",description:"At Tauri, we are working on reducing the environmental footprint of applications by using system resources where available, providing compiled systems that don't need runtime evaluation, and offering guides so that engineers can go even smaller without sacrificing on performance or security. The point is, by saving resources, we are doing our part to help you help us save the planet -- which is the only bottom line that companies in the 21st Century should care about.",source:"@site/docs/guides/05-building/app-size.md",sourceDirName:"guides/05-building",slug:"/guides/building/app-size",permalink:"/doc/v1/guides/building/app-size",draft:!1,editUrl:"https://github.com/tauri-apps/tauri-docs/edit/dev/docs/guides/05-building/app-size.md",tags:[],version:"current",lastUpdatedAt:1652462994,formattedLastUpdatedAt:"5/14/2022",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"guides",previous:{title:"Cross-Platform Compilation",permalink:"/doc/v1/guides/building/cross-platform"},next:{title:"Embedding External Binaries",permalink:"/doc/v1/guides/building/sidecar"}},u={},m=[{value:"You can&#39;t improve what you can&#39;t measure",id:"you-cant-improve-what-you-cant-measure",level:3},{value:"Think twice before adding a dependency",id:"think-twice-before-adding-a-dependency",level:3},{value:"Checklist",id:"checklist",level:2},{value:"1. Minify Javascript",id:"1-minify-javascript",level:2},{value:"Why?",id:"why",level:3},{value:"How?",id:"how",level:3},{value:"2. Optimize Dependencies",id:"2-optimize-dependencies",level:2},{value:"Why?",id:"why-1",level:3},{value:"How?",id:"how-1",level:3},{value:"3. Optimize Images",id:"3-optimize-images",level:2},{value:"Why?",id:"why-2",level:3},{value:"How?",id:"how-2",level:3},{value:"4. Remove Unnecessary Custom Fonts",id:"4-remove-unnecessary-custom-fonts",level:2},{value:"Why?",id:"why-3",level:3},{value:"How?",id:"how-3",level:3},{value:"5. Allowlist Config",id:"5-allowlist-config",level:2},{value:"Why?",id:"why-4",level:3},{value:"How?",id:"how-4",level:3},{value:"6. Rust Build-time Optimizations",id:"6-rust-build-time-optimizations",level:2},{value:"Why?",id:"why-5",level:3},{value:"How?",id:"how-5",level:3},{value:"Unstable Rust Compression Features",id:"unstable-rust-compression-features",level:3},{value:"7. Stripping",id:"7-stripping",level:2},{value:"Why?",id:"why-6",level:3},{value:"How?",id:"how-6",level:3},{value:"8. UPX",id:"8-upx",level:2},{value:"Why?",id:"why-7",level:3},{value:"How?",id:"how-7",level:3},{value:"Usage on macOS",id:"usage-on-macos",level:4}],d={toc:m};function h(e){var t=e.components,a=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"reducing-the-app-size"},"Reducing the App Size"),(0,r.kt)("p",null,"At Tauri, we are working on reducing the environmental footprint of applications by using system resources where available, providing compiled systems that don't need runtime evaluation, and offering guides so that engineers can go even smaller without sacrificing on performance or security. The point is, by saving resources, we are doing our part to help you help us save the planet -- which is the only bottom line that companies in the 21st Century should care about."),(0,r.kt)("p",null,"So if you are interested in learning how to improve your app size and performance, read on, dear friend:"),(0,r.kt)("h3",{id:"you-cant-improve-what-you-cant-measure"},"You can't improve what you can't measure"),(0,r.kt)("p",null,"Before you can optimize your app, you need to figure out what takes up space in your app!\nHere are a couple of tools that can assist you with that:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"cargo-bloat"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://github.com/RazrFalcon/cargo-bloat"},(0,r.kt)("inlineCode",{parentName:"a"},"cargo-bloat"))," is a rust utility to determine what takes the most space in your app. It gives you an excellent, sorted overview of the most significant rust functions.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"cargo-expand"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://doc.rust-lang.org/book/ch19-06-macros.html"},"Macros")," make your rust code more concise and easier to read, but they are also hidden size traps! Use ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/dtolnay/cargo-expand"},(0,r.kt)("inlineCode",{parentName:"a"},"cargo-expand"))," to see what those macros generate under the hood.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"rollup-plugin-visualizer"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://github.com/btd/rollup-plugin-visualizer"},(0,r.kt)("inlineCode",{parentName:"a"},"rollup-plugin-visualizer"))," generates beautiful (and insightful) graphs from your rollup bundle. Very convenient for figuring out what JavaScript dependencies contribute to your final bundle size the most.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"rollup-plugin-graph"))),(0,r.kt)("p",{parentName:"li"},"You noticed a dependency included in your final frontend bundle, but you are unsure why? ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ondras/rollup-plugin-graph"},(0,r.kt)("inlineCode",{parentName:"a"},"rollup-plugin-graph"))," generates graphviz compatible visualizations of your entire dependency graph."))),(0,r.kt)("p",null,"These are just a couple of tools that you might use. Make sure to check your frontend bundlers plugin list for more!"),(0,r.kt)("h3",{id:"think-twice-before-adding-a-dependency"},"Think twice before adding a dependency"),(0,r.kt)("h2",{id:"checklist"},"Checklist"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#reducing-the-app-size"},"Reducing the App Size"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#you-cant-improve-what-you-cant-measure"},"You can't improve what you can't measure")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#think-twice-before-adding-a-dependency"},"Think twice before adding a dependency")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#checklist"},"Checklist")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#1-minify-javascript"},"1. Minify Javascript"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how"},"How?")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#2-optimize-dependencies"},"2. Optimize Dependencies"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why-1"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-1"},"How?")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#3-optimize-images"},"3. Optimize Images"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why-2"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-2"},"How?")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#4-remove-unnecessary-custom-fonts"},"4. Remove Unnecessary Custom Fonts"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why-3"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-3"},"How?")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#5-allowlist-config"},"5. Allowlist Config"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why-4"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-4"},"How?")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#6-rust-build-time-optimizations"},"6. Rust Build-time Optimizations"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why-5"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-5"},"How?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#unstable-rust-compression-features"},"Unstable Rust Compression Features")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#7-stripping"},"7. Stripping"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why-6"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-6"},"How?")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#8-upx"},"8. UPX"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#why-7"},"Why?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#how-7"},"How?"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#usage-on-macos"},"Usage on macOS"))))))))),(0,r.kt)("h2",{id:"1-minify-javascript"},"1. Minify Javascript"),(0,r.kt)("h3",{id:"why"},"Why?"),(0,r.kt)("p",null,"JavaScript makes up a large portion of a typical Tauri app, so it's important to make the JavaScript as lightweight as possible."),(0,r.kt)("h3",{id:"how"},"How?"),(0,r.kt)("p",null,"You can choose among a plethora of JavaScript bundlers; popular choices are ",(0,r.kt)("a",{parentName:"p",href:"https://vitejs.dev"},"Vite"),", ",(0,r.kt)("a",{parentName:"p",href:"https://webpack.js.org"},"webpack"),", and ",(0,r.kt)("a",{parentName:"p",href:"https://rollupjs.org/guide/en/"},"rollup"),".\nAll of them can produce minified JavaScript if configured correctly, so please consult your bundler documentation for specific options.\nGenerally speaking; however, you should make sure to:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Enable tree shaking")),(0,r.kt)("p",{parentName:"li"},"This option removes unused JavaScript from your bundle. All popular bundlers enable this by default.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Enable minification")),(0,r.kt)("p",{parentName:"li"},"Minification removes unnecessary whitespace, shortens variable names, and applies other optimizations.\nMost bundlers enable this by default; a notable exception is ",(0,r.kt)("a",{parentName:"p",href:"https://rollupjs.org/guide/en/"},"rollup"),", where you need plugins like ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/TrySound/rollup-plugin-terser"},"rollup-plugin-terser")," or ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/TrySound/rollup-plugin-uglify"},"rollup-plugin-uglify"),"."),(0,r.kt)("div",{parentName:"li",className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You can use minifiers like ",(0,r.kt)("a",{parentName:"p",href:"https://terser.org"},"terser")," and ",(0,r.kt)("a",{parentName:"p",href:"https://esbuild.github.io"},"esbuild")," as standalone tools.")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Disable source maps")),(0,r.kt)("p",{parentName:"li"},"Source maps provide a pleasant developer experience when working with languages that compile to JavaScript, such as ",(0,r.kt)("a",{parentName:"p",href:"https://www.typescriptlang.org"},"TypeScript"),".\nAs source maps tend to be quite large, you must disable them when building for production.\nThey have no benefit to your end-user, so it's effectively dead weight."))),(0,r.kt)("h2",{id:"2-optimize-dependencies"},"2. Optimize Dependencies"),(0,r.kt)("p",null,"Many popular libraries have smaller and faster alternatives that you can choose instead."),(0,r.kt)("h3",{id:"why-1"},"Why?"),(0,r.kt)("p",null,"Most libraries you use depend on many libraries themselves,\nso a library that looks inconspicuous at first glance might add ",(0,r.kt)("strong",{parentName:"p"},"several megabytes")," worth of code to your app."),(0,r.kt)("h3",{id:"how-1"},"How?"),(0,r.kt)("p",null,"You can use ",(0,r.kt)("a",{parentName:"p",href:"https://bundlephobia.com"},"Bundlephobia")," to find the cost of JavaScript dependencies.\nInspecting the cost of rust dependencies is generally harder since the compiler does many optimizations."),(0,r.kt)("p",null,"If you find a library that seems excessively large, google around, chances are someone else already had the same thought and created an alternative.\nA good example is ",(0,r.kt)("a",{parentName:"p",href:"https://momentjs.com"},"Moment.js")," and it's ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/you-dont-need/You-Dont-Need-Momentjs"},"Many alternatives"),"."),(0,r.kt)("p",null,"But keep in mind: ",(0,r.kt)("strong",{parentName:"p"},"The best dependency is no dependency"),", meaning that you should always prefer language builtins over 3rd party packages."),(0,r.kt)("h2",{id:"3-optimize-images"},"3. Optimize Images"),(0,r.kt)("h3",{id:"why-2"},"Why?"),(0,r.kt)("p",null,"According to the ",(0,r.kt)("a",{parentName:"p",href:"https://httparchive.org"},"Http Archive"),", images are the ",(0,r.kt)("a",{parentName:"p",href:"https://httparchive.org/reports/page-weight#bytesImg"},"biggest contributor to website weight"),". So if your app includes have background images or icons, make sure to optimize them!"),(0,r.kt)("h3",{id:"how-2"},"How?"),(0,r.kt)("p",null,"You can choose between a variety of manual options (",(0,r.kt)("a",{parentName:"p",href:"https://www.gimp.org"},"GIMP"),", ",(0,r.kt)("a",{parentName:"p",href:"https://www.adobe.com/de/products/photoshop.html"},"Photoshop"),", ",(0,r.kt)("a",{parentName:"p",href:"https://squoosh.app"},"Squoosh"),") or plugins for your favorite frontend build tools (",(0,r.kt)("a",{parentName:"p",href:"https://github.com/JonasKruckenberg/imagetools"},"vite-imagetools"),", ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vbenjs/vite-plugin-imagemin"},"vite-plugin-imagemin"),", ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/webpack-contrib/image-minimizer-webpack-plugin"},"image-minimizer-webpack-plugin"),")."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"imagemin")," library most of the plugins use is ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/imagemin/imagemin/issues/385"},"officially unmaintained"),"."))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Use modern image formats")),(0,r.kt)("p",{parentName:"li"},"Formats such as ",(0,r.kt)("inlineCode",{parentName:"p"},"webp")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"avif")," offer size reductions of ",(0,r.kt)("strong",{parentName:"p"},"up to 95%")," compared to jpeg while maintaining excellent visual accuracy. You can use tools such as ",(0,r.kt)("a",{parentName:"p",href:"https://squoosh.app"},"Squoosh")," to try different formats on your images.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Size images accordingly")),(0,r.kt)("p",{parentName:"li"},"No one appreciates you shipping the 6K raw image with your app, so make sure to size your image accordingly. Images that appear large on-screen should be sized larger than images that take up less screen space.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Don't use Responsive Images")),(0,r.kt)("p",{parentName:"li"},"In a Web Environment, you are supposed to use ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images"},"Responsive Images")," to load the correct image size for each user dynamically. You are not building a simple website, though: All your images are already downloaded. So using Responsive Images only bloat your app with redundant copies.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Remove Metadata")),(0,r.kt)("p",{parentName:"li"},"Images that were taken straight from a camera or stock photo side often include metadata about the Camera and Lens model or Photographer. Not only are those wasted bytes, but metadata properties can also hold potentially sensitive information such as the time, day, and location of the photo."))),(0,r.kt)("h2",{id:"4-remove-unnecessary-custom-fonts"},"4. Remove Unnecessary Custom Fonts"),(0,r.kt)("p",null,"Consider not shipping custom fonts with your app and relying on system fonts instead. If you must ship custom fonts, make sure they are in modern, optimized formats such as ",(0,r.kt)("inlineCode",{parentName:"p"},"woff2"),"."),(0,r.kt)("h3",{id:"why-3"},"Why?"),(0,r.kt)("p",null,'Fonts can be pretty big, so using the fonts already included in the Operating System reduces the footprint of your app. It also avoids FOUT (Flash of Unstyled Text) and makes your app feel more "native" since it uses the same font as all other apps.'),(0,r.kt)("p",null,"If you must include custom fonts, make sure you include them in modern formats such as ",(0,r.kt)("inlineCode",{parentName:"p"},"woff2")," as those tend to be way smaller than legacy formats."),(0,r.kt)("h3",{id:"how-3"},"How?"),(0,r.kt)("p",null,"Use so-called ",(0,r.kt)("strong",{parentName:"p"},'"System Font Stacks"')," in your CSS. There are a number of variations, but here are 3 basic ones to get you started:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Sans-serif"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-css"},"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial,\n  sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji';\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Serif"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-css"},"font-family: Iowan Old Style, Apple Garamond, Baskerville, Times New Roman, Droid\n    Serif, Times, Source Serif Pro, serif, Apple Color Emoji, Segoe UI Emoji, Segoe\n    UI Symbol;\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Monospace"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-css"},"font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation\n    Mono, monospace;\n")),(0,r.kt)("h2",{id:"5-allowlist-config"},"5. Allowlist Config"),(0,r.kt)("p",null,"You can reduce the size of your app by only enabling the Tauri API features you need in the ",(0,r.kt)("inlineCode",{parentName:"p"},"allowlist")," config."),(0,r.kt)("h3",{id:"why-4"},"Why?"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"allowlist")," config determines what API features to enable; disabled features will ",(0,r.kt)("strong",{parentName:"p"},"not be compiled into your app"),". This is an easy way of shedding some extra weight."),(0,r.kt)("h3",{id:"how-4"},"How?"),(0,r.kt)("p",null,"An example from a typical ",(0,r.kt)("inlineCode",{parentName:"p"},"tauri.conf.json"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tauri": {\n    "allowlist": {\n      "all": false,\n      "fs": {\n        "writeFile": true\n      },\n      "shell": {\n        "execute": true\n      },\n      "dialog": {\n        "save": true\n      }\n    }\n  }\n}\n')),(0,r.kt)("h2",{id:"6-rust-build-time-optimizations"},"6. Rust Build-time Optimizations"),(0,r.kt)("p",null,"Configure your cargo project to take advantage of rusts size optimization features.\n",(0,r.kt)("a",{parentName:"p",href:"https://lifthrasiir.github.io/rustlog/why-is-a-rust-executable-large.html"},"Why is a rust executable large ?")," provides an excellent explanation on why this matters and an in-depth walkthrough. At the same time, ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/johnthagen/min-sized-rust"},"Minimizing Rust Binary Size")," is more up-to-date and has a couple of extra recommendations."),(0,r.kt)("h3",{id:"why-5"},"Why?"),(0,r.kt)("p",null,"Rust is notorious for producing large binaries, but you can instruct the compiler to optimize the final executable's size."),(0,r.kt)("h3",{id:"how-5"},"How?"),(0,r.kt)("p",null,'Cargo exposes several options that determine how the compiler generates your binary.\nThe "recommended" options for Tauri apps are these:'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-toml"},'[profile.release]\npanic = "abort" # Strip expensive panic clean-up logic\ncodegen-units = 1 # Compile crates one after another so the compiler can optimize better\nlto = true # Enables link to optimizations\nopt-level = "s" # Optimize for binary size\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"There is also ",(0,r.kt)("inlineCode",{parentName:"p"},'opt-level = "z"')," available to reduce the resulting binary size. ",(0,r.kt)("inlineCode",{parentName:"p"},'"s"')," and ",(0,r.kt)("inlineCode",{parentName:"p"},'"z"')," can sometimes be smaller than the other, so test it with your application!"),(0,r.kt)("p",{parentName:"div"},"We've seen smaller binary sizes from ",(0,r.kt)("inlineCode",{parentName:"p"},'"s"')," for Tauri example applications, but real-world applications can always differ."))),(0,r.kt)("p",null,"For a detailed explanation of each option and a bunch more, refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://doc.rust-lang.org/cargo/reference/profiles.html"},"Cargo books Profiles section"),"."),(0,r.kt)("h3",{id:"unstable-rust-compression-features"},"Unstable Rust Compression Features"),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The following suggestions are all unstable features and require a nightly toolchain. See the ",(0,r.kt)("a",{parentName:"p",href:"https://doc.rust-lang.org/cargo/reference/unstable.html#unstable-features"},"Unstable Features")," documentation for more information on what this involves."))),(0,r.kt)("p",null,"The following methods involve using unstable compiler features and require the rust nightly toolchain. If you don't have the nightly toolchain + ",(0,r.kt)("inlineCode",{parentName:"p"},"rust-src")," nightly component added, try the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"rustup toolchain install nightly\nrustup component add rust-src --toolchain nightly\n")),(0,r.kt)("p",null,"The Rust Standard Library comes precompiled. This means rust is faster to install, but also that the compiler can't optimize the Standard Library. You can apply the optimization options for the rest of your binary + dependencies to the std with an unstable flag. This flag requires specifying your target, so know the target triple you are targeting."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cargo +nightly build --release -Z build-std --target x86_64-unknown-linux-gnu\n")),(0,r.kt)("p",null,"If you are using ",(0,r.kt)("inlineCode",{parentName:"p"},'panic = "abort"')," in your release profile optimizations, you need to make sure the ",(0,r.kt)("inlineCode",{parentName:"p"},"panic_abort")," crate is compiled with std. Additionally, an extra std feature can further reduce the binary size. The following applies both:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cargo +nightly build --release -Z build-std=std,panic_abort -Z build-std-features=panic_immediate_abort --target x86_64-unknown-linux-gnu\n")),(0,r.kt)("p",null,"See the unstable documentation for more details about ",(0,r.kt)("a",{parentName:"p",href:"https://doc.rust-lang.org/cargo/reference/unstable.html#build-std"},(0,r.kt)("inlineCode",{parentName:"a"},"-Z build-std"))," and ",(0,r.kt)("a",{parentName:"p",href:"https://doc.rust-lang.org/cargo/reference/unstable.html#build-std-features"},(0,r.kt)("inlineCode",{parentName:"a"},"-Z build-std-features")),"."),(0,r.kt)("h2",{id:"7-stripping"},"7. Stripping"),(0,r.kt)("p",null,"Use strip utilities to remove debug symbols from your compiled app."),(0,r.kt)("h3",{id:"why-6"},"Why?"),(0,r.kt)("p",null,'Your compiled app includes so-called "Debug Symbols" that include function and variable names. Your end-users will probably not care about Debug Symbols, so this is a pretty surefire way to save some bytes!'),(0,r.kt)("h3",{id:"how-6"},"How?"),(0,r.kt)("p",null,"The easiest way is to use the famous ",(0,r.kt)("inlineCode",{parentName:"p"},"strip")," utility to remove this debugging information."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"strip target/release/my_application\n")),(0,r.kt)("p",null,"See your local ",(0,r.kt)("inlineCode",{parentName:"p"},"strip")," manpage for more information and flags that can be used to specify what information gets stripped out from the binary."),(0,r.kt)("h2",{id:"8-upx"},"8. UPX"),(0,r.kt)("p",null,"UPX, ",(0,r.kt)("strong",{parentName:"p"},"Ultimate Packer for eXecutables"),", is a dinosaur amongst the binary packers. This 23-year old, well-maintained piece of kit is GPL-v2 licensed with a pretty liberal usage declaration. Our understanding of the licensing is that you can use it for any purposes (commercial or otherwise) without needing to change your license unless you modify the source code of UPX."),(0,r.kt)("h3",{id:"why-7"},"Why?"),(0,r.kt)("p",null,"Maybe your target audience has very slow internet, or your app needs to fit on a tiny USB stick, and all the above steps haven't resulted in the savings you need. Fear not, as we have one last trick up our sleeves:"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/upx/upx"},"UPX")," compresses your binary and creates a self-extracting executable that decompresses itself at runtime."),(0,r.kt)("h3",{id:"how-7"},"How?"),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You should know that this technique might flag your binary as a virus on Windows and macOS - so use at your own discretion, and as always, validate with ",(0,r.kt)("a",{parentName:"p",href:"https://frida.re/docs/home/"},"Frida")," and do real distribution testing!"))),(0,r.kt)("h4",{id:"usage-on-macos"},"Usage on macOS"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"brew install upx\nyarn tauri build\nupx --ultra-brute src-tauri/target/release/bundle/macos/app.app/Contents/macOS/app\n\n                        Ultimate Packer for eXecutables\n                            Copyright (C) 1996 - 2018\nUPX 3.95        Markus Oberhumer, Laszlo Molnar & John Reiser   Aug 26th 2018\n\n        File size         Ratio      Format      Name\n    --------------------   ------   -----------   -----------\n    963140 ->    274448   28.50%   macho/amd64   app\n")))}h.isMDXComponent=!0}}]);