"use strict";(self.webpackChunktauri_docs=self.webpackChunktauri_docs||[]).push([[6953],{3905:function(e,n,t){t.d(n,{Zo:function(){return d},kt:function(){return m}});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=i.createContext({}),u=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},d=function(e){var n=u(e.components);return i.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},c=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=u(t),m=a,g=c["".concat(s,".").concat(m)]||c[m]||p[m]||r;return t?i.createElement(g,o(o({ref:n},d),{},{components:t})):i.createElement(g,o({ref:n},d))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=c;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var u=2;u<r;u++)o[u]=t[u];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}c.displayName="MDXCreateElement"},131:function(e,n,t){t.r(n),t.d(n,{assets:function(){return d},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return p}});var i=t(87462),a=t(63366),r=(t(67294),t(3905)),o=["components"],l={sidebar_label:"Windows",sidebar_position:2},s="Windows Application Distribution",u={unversionedId:"guides/distribution/windows",id:"guides/distribution/windows",title:"Windows Application Distribution",description:"Tauri applications for Windows are distributed with a Microsoft Installer (.msi files). The Tauri CLI automatically bundles your application code in this format, providing options to code sign your application. This guide provides information on available customizations for the installer.",source:"@site/docs/guides/06-distribution/windows.md",sourceDirName:"guides/06-distribution",slug:"/guides/distribution/windows",permalink:"/doc/v1/guides/distribution/windows",draft:!1,editUrl:"https://github.com/tauri-apps/tauri-docs/edit/dev/docs/guides/06-distribution/windows.md",tags:[],version:"current",lastUpdatedAt:1652462994,formattedLastUpdatedAt:"5/14/2022",sidebarPosition:2,frontMatter:{sidebar_label:"Windows",sidebar_position:2},sidebar:"guides",previous:{title:"App Publishing",permalink:"/doc/v1/guides/distribution/publishing"},next:{title:"Windows Code Signing",permalink:"/doc/v1/guides/distribution/sign-windows"}},d={},p=[{value:"Distributing a 32-bit executable",id:"distributing-a-32-bit-executable",level:2},{value:"Using a fixed version of the Webview2 Runtime",id:"using-a-fixed-version-of-the-webview2-runtime",level:2},{value:"Customizing the Windows Installer",id:"customizing-the-windows-installer",level:2},{value:"Replacing the installer code with a custom WiX file",id:"replacing-the-installer-code-with-a-custom-wix-file",level:3},{value:"Extending the installer with WiX fragments",id:"extending-the-installer-with-wix-fragments",level:3},{value:"i18n",id:"i18n",level:2},{value:"Code signing",id:"code-signing",level:2}],c={toc:p};function m(e){var n=e.components,t=(0,a.Z)(e,o);return(0,r.kt)("wrapper",(0,i.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"windows-application-distribution"},"Windows Application Distribution"),(0,r.kt)("p",null,"Tauri applications for Windows are distributed with a Microsoft Installer (",(0,r.kt)("inlineCode",{parentName:"p"},".msi")," files). The Tauri CLI automatically bundles your application code in this format, providing options to code sign your application. This guide provides information on available customizations for the installer."),(0,r.kt)("h2",{id:"distributing-a-32-bit-executable"},"Distributing a 32-bit executable"),(0,r.kt)("p",null,"The Tauri CLI compiles your executable using your machine's architecture by default. You can target a different one using the ",(0,r.kt)("inlineCode",{parentName:"p"},"target")," argument. For instance, to generate an installer for the x86 architecture, you can execute ",(0,r.kt)("inlineCode",{parentName:"p"},"tauri build --target i686-pc-windows-msvc")," after installing the ",(0,r.kt)("em",{parentName:"p"},"i686-pc-windows-msvc")," target running ",(0,r.kt)("inlineCode",{parentName:"p"},"rustup target add i686-pc-windows-msvc"),". You can see the list of available targets running ",(0,r.kt)("inlineCode",{parentName:"p"},"rustup target list"),"."),(0,r.kt)("h2",{id:"using-a-fixed-version-of-the-webview2-runtime"},"Using a fixed version of the Webview2 Runtime"),(0,r.kt)("p",null,"By default, the Tauri installer downloads and installs the Webview2 Runtime if it is not already installed (on Windows 11, the runtime is distributed as part of the operating system)."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You can remove the Webview2 Runtime download check from the installer by setting ",(0,r.kt)("a",{parentName:"p",href:"../../api/config/#tauri.bundle.windows.wix.skipWebviewInstall"},"tauri.bundle.windows.wix.skipWebviewInstall")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),". Your application WON'T work if the user does not have the runtime installed."))),(0,r.kt)("p",null,"Using the runtime provided by the system is great for security as the webview vulnerability patches are managed by Windows. If you want to control the Webview2 distribution on each of your applications, either to manage the release patches yourself or distribute applications on environments where internet connection might not be available. In that case, Tauri can bundle the runtime files for you."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Download the Webview2 fixed version runtime on the ",(0,r.kt)("a",{parentName:"li",href:"https://developer.microsoft.com/en-us/microsoft-edge/webview2/#download-section"},"official website"),", a ",(0,r.kt)("inlineCode",{parentName:"li"},".cab")," file for the selected architecture. In this example, the downloaded filename is Microsoft.WebView2.FixedVersionRuntime.98.0.1108.50.x64.cab"),(0,r.kt)("li",{parentName:"ul"},"Extract the file to the core folder: ",(0,r.kt)("inlineCode",{parentName:"li"},"Expand .\\Microsoft.WebView2.FixedVersionRuntime.98.0.1108.50.x64.cab -F:* ./src-tauri")),(0,r.kt)("li",{parentName:"ul"},"Configure the Webview2 runtime path on ",(0,r.kt)("inlineCode",{parentName:"li"},"tauri.conf.json"),":")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tauri": {\n    "bundle": {\n      "windows": {\n        "webviewFixedRuntimePath": "./Microsoft.WebView2.FixedVersionRuntime.98.0.1108.50.x64/"\n      }\n    }\n  }\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"tauri build")," to produce the Windows Installer with the fixed Webview2 runtime.")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Distributing a fixed Webview2 Runtime version increases the Windows Installer by around 150MB."))),(0,r.kt)("h2",{id:"customizing-the-windows-installer"},"Customizing the Windows Installer"),(0,r.kt)("p",null,"The Windows Installer package is built using the ",(0,r.kt)("a",{parentName:"p",href:"https://wixtoolset.org/documentation/manual/v3/"},"WiX Toolset v3"),". Currently, you can change it by using a custom WiX source code (an XML file with a ",(0,r.kt)("inlineCode",{parentName:"p"},".wxs")," file extension) or through WiX fragments."),(0,r.kt)("h3",{id:"replacing-the-installer-code-with-a-custom-wix-file"},"Replacing the installer code with a custom WiX file"),(0,r.kt)("p",null,"The Windows Installer XML defined by Tauri is configured to work for the common use case of simple webview-based applications; you can find it ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/tauri-apps/tauri/blob/dev/tooling/bundler/src/bundle/windows/templates/main.wxs"},"here"),". It uses ",(0,r.kt)("a",{parentName:"p",href:"https://docs.rs/handlebars/latest/handlebars/"},"handlebars")," so the Tauri CLI can brand your installer according to your ",(0,r.kt)("inlineCode",{parentName:"p"},"tauri.conf.json")," definition. If you need a completely different installer, a custom template file can be configured on ",(0,r.kt)("a",{parentName:"p",href:"../../api/config/#tauri.bundle.windows.wix.template"},"tauri.bundle.windows.wix.template"),"."),(0,r.kt)("h3",{id:"extending-the-installer-with-wix-fragments"},"Extending the installer with WiX fragments"),(0,r.kt)("p",null,"A ",(0,r.kt)("a",{parentName:"p",href:"https://wixtoolset.org/documentation/manual/v3/xsd/wix/fragment.html"},"WiX fragment")," is a container where you can configure almost everything offered by WiX. In this example, we will define a fragment that writes two registry entries:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="utf-8"?>\n<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">\n    <Fragment>\n        \x3c!-- these registry entries should be installed to the target user\'s machine --\x3e\n        <DirectoryRef Id="TARGETDIR">\n            \x3c!-- groups together the registry entries to be installed --\x3e\n            \x3c!-- Note the unique `Id` we provide here --\x3e\n            <Component Id="MyFragmentRegistryEntries" Guid="*">\n                \x3c!-- the registry key willbe under HKEY_CURRENT_USER\\Software\\MyCompany\\MyApplicationName --\x3e\n                \x3c!-- Tauri uses the second portion of the bundle identifier as the `MyCompany` name (e.g. `tauri-apps` in `com.tauri-apps.test`)  --\x3e\n                <RegistryKey Root="HKCU"\n                            Key="Software\\MyCompany\\MyApplicationName"\n                    Action="createAndRemoveOnUninstall">\n                    \x3c!-- values to persist on the registry --\x3e\n                    <RegistryValue Type="integer" Name="SomeIntegerValue" Value="1" KeyPath="yes"/>\n                    <RegistryValue Type="string" Value="Default Value"/>\n                </RegistryKey>\n            </Component>\n        </DirectoryRef>\n    </Fragment>\n</Wix>\n')),(0,r.kt)("p",null,"Save the fragment file with the ",(0,r.kt)("inlineCode",{parentName:"p"},".wxs")," extension somewhere in your project and reference it on ",(0,r.kt)("inlineCode",{parentName:"p"},"tauri.conf.json"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tauri": {\n    "bundle": {\n      "windows": {\n        "wix": {\n          "fragmentPaths": ["./path/to/registry.wxs"],\n          "componentRefs": ["MyFragmentRegistryEntries"]\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Note that ",(0,r.kt)("inlineCode",{parentName:"p"},"ComponentGroup"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Component"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"FeatureGroup"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Feature")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Merge")," element ids must be referenced on the ",(0,r.kt)("inlineCode",{parentName:"p"},"wix")," object of ",(0,r.kt)("inlineCode",{parentName:"p"},"tauri.conf.json")," on the ",(0,r.kt)("inlineCode",{parentName:"p"},"componentGroupRefs"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"componentRefs"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"featureGroupRefs"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"featureRefs")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"mergeRefs")," respectively in order to be included on the installer."),(0,r.kt)("h2",{id:"i18n"},"i18n"),(0,r.kt)("p",null,"The Windows Installer is built using the ",(0,r.kt)("inlineCode",{parentName:"p"},"en-US")," language by default. i18n (shorthand for internationalization) can be configured using the ",(0,r.kt)("a",{parentName:"p",href:"../../api/config/#tauri.bundle.windows.wix.language"},"tauri.bundle.windows.wix.language")," property, defining the languages Tauri should build an installer against. You can find the language names to use on the Language-Culture column ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/win32/msi/localizing-the-error-and-actiontext-tables"},"here"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Compiling an installer for a single language")),(0,r.kt)("p",null,"To create a single installer targeting a specific language, set the ",(0,r.kt)("inlineCode",{parentName:"p"},"language")," value to a string:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tauri": {\n    "bundle": {\n      "windows": {\n        "wix": {\n          "language": "fr-FR"\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Compiling an installer for each language in a list")),(0,r.kt)("p",null,"To compile an installer targeting a list of languages, use an array. A specific installer for each language will be created, with the language key as a suffix:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tauri": {\n    "bundle": {\n      "windows": {\n        "wix": {\n          "language": ["en-US", "pt-BR", "fr-FR"]\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Configuring the installer for each language")),(0,r.kt)("p",null,"A configuration object can be defined for each language to configure localization strings:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tauri": {\n    "bundle": {\n      "windows": {\n        "wix": {\n          "language": {\n            "en-US": null,\n            "pt-BR": {\n              "localePath": "./wix/locales/pt-BR.wxl"\n            }\n          }\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"localePath")," property defines the path to a language file, a XML configuring the language culture:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<WixLocalization Culture="en-US" xmlns="http://schemas.microsoft.com/wix/2006/localization">\n    <String Id="LaunchApp">Launch MyApplicationName</String>\n    <String Id="DowngradeErrorMessage">A newer version of MyApplicationName is already installed.</String>\n    <String Id="PathEnvVarFeature">Add the install location of the MyApplicationName executable to the PATH system environment variable. This allows the MyApplicationName executable to be called from any location.</String>\n    <String Id="InstallAppFeature">Installs MyApplicationName.</String>\n</WixLocalization>\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"WixLocalization")," element's ",(0,r.kt)("inlineCode",{parentName:"p"},"Culture")," field must match the configured language."))),(0,r.kt)("p",null,"Currently Tauri references the following locale strings: ",(0,r.kt)("inlineCode",{parentName:"p"},"LaunchApp"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"DowngradeErrorMessage"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"PathEnvVarFeature")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"InstallAppFeature"),". You can define your own strings and reference them on your custom template or fragments with ",(0,r.kt)("inlineCode",{parentName:"p"},'"!(loc.TheStringId)"'),". See the ",(0,r.kt)("a",{parentName:"p",href:"https://wixtoolset.org/documentation/manual/v3/howtos/ui_and_localization/make_installer_localizable.html"},"WiX localization documentation")," for more information."),(0,r.kt)("h2",{id:"code-signing"},"Code signing"),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"/doc/v1/guides/distribution/sign-windows"},"Code signing guide"),"."))}m.isMDXComponent=!0}}]);